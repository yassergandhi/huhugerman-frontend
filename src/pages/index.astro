---
import Layout from '../layouts/Layout.astro';
---
<Layout title="Inicio">
  <div class="container">
  <h1 style="text-align:center; margin-bottom: 0.5rem;">
    Elige tu curso de alemÃ¡n
  </h1>

  <p style="text-align:center; margin-bottom: 2rem;">
    WÃ¤hle deinen Kurs
  </p>

  <div class="grid">
    <div class="card">
      <span class="status-badge">Primer contacto</span>
      <h2>ğŸ‡©ğŸ‡ª AlemÃ¡n 1</h2>
      <p>
        Empieza desde cero. Aprende a presentarte, hacer preguntas y hablar de ti,
        tu familia y tu entorno en alemÃ¡n, paso a paso.
      </p>
      <button class="btn js-course-btn" data-url="/aleman1">
        Ir al Curso
      </button>
    </div>

    <div class="card">
      <span class="status-badge">Uso cotidiano</span>
      <h2>ğŸ‡©ğŸ‡ª AlemÃ¡n 2</h2>
      <p>
        Usa el alemÃ¡n en situaciones reales: pedir comida, comprar,
        hablar con amigos y contar quÃ© haces el fin de semana.
      </p>
      <button class="btn js-course-btn" data-url="/aleman2">
        Ir al Curso
      </button>
    </div>
  </div>
</div>


  <script>
    import { supabase } from '../lib/supabase';
    
    // Interceptamos los clicks para asegurar que estÃ©n logueados
    const buttons = document.querySelectorAll('.js-course-btn');
    
    buttons.forEach(btn => {
      btn.addEventListener('click', async (e) => {
        const url = e.target.getAttribute('data-url');
        const { data: { session } } = await supabase.auth.getSession();
        
        if (!session) {
          // Si no hay sesiÃ³n, loguear primero y redirigir al curso
          await supabase.auth.signInWithOAuth({
            provider: 'google',
            options: { redirectTo: window.location.origin + url }
          });
        } else {
          window.location.href = url;
        }
      });
    });
  </script>
</Layout>
